<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Beer Line Length Calculator</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: auto; }
        label { display: block; margin-top: 10px; }
        .info { font-size: 0.9em; color: #555; }
    </style>
</head>
<body>
    <h1>Beer Line Length Calculator</h1>
    <p>This calculator helps you find the correct beer line length for a balanced pour based on your system's regulator pressure and line resistance. This helps prevent foaming and ensures the beer stays carbonated at the correct level.</p>
    
    <!-- Beer Type Selection with Carbonation Defaults -->
    <label>Choose Beer Type:</label>
    <select id="beerType" onchange="setCarbonationLevel()">
        <option value="2.2">Lager (2.2 Vol CO₂)</option>
        <option value="2.4">Pilsner (2.4 Vol CO₂)</option>
        <option value="2.6">Ale (2.6 Vol CO₂)</option>
        <option value="2.8">Wheat Beer (2.8 Vol CO₂)</option>
        <option value="3.0">Saison (3.0 Vol CO₂)</option>
    </select>
    <p class="info">Select your beer type to set a carbonation level. Different beer styles are traditionally served with different levels of carbonation.</p>

    <!-- Input fields for Calculator -->
    <label>Regulator Pressure (PSI):</label>
    <input type="number" id="regulatorPressure" value="11">
    <p class="info">The pressure set at the regulator based on your desired carbonation level and storage temperature.</p>

    <label>Line Resistance per Foot (PSI per foot):</label>
    <input type="number" id="lineResistance" value="2" step="0.1">
    <p class="info">For a 3/16" beer line, the default resistance is about 2 PSI per foot. Larger diameter lines have lower resistance.</p>

    <label>Keg Height Difference (feet):</label>
    <input type="number" id="kegHeightDifference" value="0">
    <p class="info">If the keg is below the faucet, set the height difference in feet. This affects the required pressure to push the beer upward.</p>

    <!-- Calculate button -->
    <button onclick="calculateBeerLineLength()">Calculate Beer Line Length</button>

    <!-- Output section -->
    <h2>Results</h2>
    <p id="output"></p>

    <!-- Carbonation Chart Information -->
    <h2>Carbonation Chart Reference</h2>
    <p>If you'd like to see a detailed carbonation chart for different beer styles, check out <a href="https://www.kegerators.com/articles/carb-chart/" target="_blank">this guide on carbonation levels</a>.</p>

    <script>
        function setCarbonationLevel() {
            const beerType = document.getElementById("beerType");
            const carbonationLevel = parseFloat(beerType.value);
            const temperatureCelsius = 3; // Set a default temperature for calculation

            // Estimate the equilibrium pressure needed for the selected carbonation level
            let equilibriumPressure;
            if (carbonationLevel === 2.2 && temperatureCelsius === 3) {
                equilibriumPressure = 10.8;  // for Lager at 3°C
            } else if (carbonationLevel === 2.4 && temperatureCelsius === 3) {
                equilibriumPressure = 11.5;  // for Pilsner at 3°C
            } else if (carbonationLevel === 2.6 && temperatureCelsius === 3) {
                equilibriumPressure = 12.3;  // for Ale at 3°C
            } else if (carbonationLevel === 2.8 && temperatureCelsius === 3) {
                equilibriumPressure = 13.0;  // for Wheat Beer at 3°C
            } else if (carbonationLevel === 3.0 && temperatureCelsius === 3) {
                equilibriumPressure = 13.7;  // for Saison at 3°C
            } else {
                equilibriumPressure = 11; // default to typical draft setup
            }

            // Set recommended regulator pressure for selected beer type
            document.getElementById("regulatorPressure").value = equilibriumPressure.toFixed(1);
        }

        function calculateBeerLineLength() {
            // Get values from input fields
            let regulatorPressure = parseFloat(document.getElementById("regulatorPressure").value);
            let lineResistance = parseFloat(document.getElementById("lineResistance").value);
            let kegHeightDifference = parseFloat(document.getElementById("kegHeightDifference").value);

            // Calculate gravity adjustment (0.5 PSI per foot of height difference)
            let gravityAdjustment = 0.5 * kegHeightDifference;

            // Calculate total pressure drop required in the line
            let totalPressureDrop = regulatorPressure - gravityAdjustment;

            // Calculate required line length
            let lineLength = totalPressureDrop / lineResistance;

            // Display the result
            document.getElementById("output").innerText = 
                `Required Beer Line Length: ${lineLength.toFixed(2)} feet`;
        }

        // Set default carbonation level on page load
        setCarbonationLevel();
    </script>
</body>
</html>
